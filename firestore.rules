rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {
    // 특정 사용자만 쓰기 권한 부여
    // 읽기는 모든 사용자에게 허용
    match /{document=**} {
      // 누구나 읽기 가능
      allow read: if true;
      
      // 특정 이메일을 가진 사용자만 쓰기 가능
      // Firebase 콘솔에서 Authentication을 설정하고 해당 이메일로 계정을 만들어야 합니다
      allow write: if request.auth != null && 
                    request.auth.token.email == "rkseksgkrns@gmail.com";
    }
    
    // 특정 컬렉션에 대한 세부 규칙
    match /auctions/{auctionId} {
      // 누구나 읽기 가능
      allow read: if true;
      
      // 특정 사용자만 쓰기 가능
      allow write: if request.auth != null && 
                    request.auth.token.email == "rkseksgkrns@gmail.com";
      
      // 문서 구조 검증
      allow create: if request.resource.data.realmId is string &&
                     request.resource.data.id is number &&
                     request.auth != null &&
                     request.auth.token.email == "rkseksgkrns@gmail.com";
    }
  }
}
